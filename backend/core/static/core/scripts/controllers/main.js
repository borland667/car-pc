// Generated by CoffeeScript 1.6.3
(function() {
  angular.module('carPc').controller('MainCtrl', function($scope, toaster, SYSTEM_STATUS_UPDATE, systemStatus, video) {
    $scope.systemStatus = systemStatus.getStatus();
    $scope.$on(SYSTEM_STATUS_UPDATE, function(event, status) {
      return $scope.systemStatus = status;
    });
    $scope.toggleVideo = function() {
      var promise;
      if ($scope.systemStatus.VIDEO_STARTED === '1') {
        promise = video.stopCapture();
      } else {
        promise = video.startCapture();
      }
      promise.success(function() {
        return systemStatus.loadStatus();
      });
      return promise.error(function(data, status, headers, config) {
        console.log(status, headers, config);
        return toaster.pop('error', 'Error', 'Video capturing error: ' + status);
      });
    };
    return systemStatus.loadStatus();
  });

}).call(this);
